// @prettier-ignore
{
    "format_version": "1.10.0",
    "minecraft:client_entity": {
        "description": {
            "identifier": "gm1_ord:eggman",
            "materials": {
                "default": "entity_alphatest",
                "additive": "gm1_ord_animated_additive",
                "alpha_blend": "entity_alphablend"
            },
            "textures": {
                "default": "textures/gm1/ord/entity/eggmobile",
                "scuffed": "textures/gm1/ord/entity/eggmobile_scuffed",
                "negative": "textures/gm1/ord/entity/eggmobile_negative",
                "laser": "textures/gm1/ord/entity/eggman/laser",
                "energy_shield": "textures/gm1/ord/entity/eggman/energy_shield",
                "hand_shell": "textures/gm1/ord/entity/eggman/hand"
            },
            "geometry": { "default": "geometry.gm1_ord.eggmobile", "laser": "geometry.gm1_ord.eggman_laser", "energy_shield": "geometry.gm1_ord.eggman_energy_shield", "hand_shell": "geometry.gm1_ord.eggmobile_gadget_hand_shell" },
            "render_controllers": [
                {"controller.render.gm1_ord.eggmobile": "!v.negative"},
                {"controller.render.gm1_ord.eggmobile_negative": "v.negative"},
                {"controller.render.gm1_ord.eggman_laser_gadget": "v.active_gadget == 1"},
                {"controller.render.gm1_ord.eggman_tracking_laser": "v.is_using_gadget && !v.is_shooting_laser"},
                {
                    "controller.render.gm1_ord.eggman_charging_shooting_laser": "v.is_using_gadget && (v.is_charging_laser || v.is_shooting_laser)"
                },
                {"controller.render.gm1_ord.energy_shield": "v.at_shrine"},
                {"controller.render.gm1_ord.eggmobile": "!v.negative"},
                {"controller.render.gm1_ord.eggman_hand_shell": "!v.negative"}
            ],
            "animations": {
                //global
                "engine": "animation.gm1_ord.eggmobile.engine",

             	"thrusters": "animation.gm1_ord.eggmobile.thrusters",
                "rotate_shield": "animation.gm1_ord.shield.rotate_to_player",   
                "hover": "animation.gm1_ord.eggmobile.hover",
                "idle": "animation.gm1_ord.eggman.idle",
                "evil_laugh": "animation.gm1_ord.eggmobile.evil_laugh",
                "shake_fist_1": "animation.gm1_ord.eggmobile.shake_fist_1",
                "shake_fist_2": "animation.gm1_ord.eggmobile.shake_fist_2",
                "engine_sfx": "animation.gm1_ord.eggmobile.engine_sfx",
                "gadget_sfx":"animation.gm1_ord.eggmobile.gadget_sfx",
                "damage_sfx":"animation.gm1_ord.eggmobile.damage_sfx",
                "ring_drop_sfx":"animation.gm1_ord.eggmobile.ring_drop_sfx",
                "movement_controller": "controller.animation.gm1_ord.eggman.movement",
                //hit
                "hit": "animation.gm1_ord.eggmobile.hit",
                "hit_controller": "controller.animation.gm1_ord.eggman.hit",
                //prestun & stun
                "stun": "animation.gm1_ord.eggmobile.stun_loop",
                "stun_exit":"animation.gm1_ord.eggmobile.stun_exit",
                "stun_sfx": "animation.gm1_ord.eggmobile.stun_sfx",
                "stun_loop_sfx": "animation.gm1_ord.eggmobile.stun_loop_sfx",
                "prestun_sfx": "animation.gm1_ord.eggmobile.prestun_sfx",
                "prestun_vfx": "animation.gm1_ord.eggman.prestun_vfx",
                "stun_controller": "controller.animation.gm1_ord.eggman.stun",
                //fight
                "intro": "animation.gm1_ord.eggmobile.intro",
                "outro": "animation.gm1_ord.eggmobile.outro",
                "outro_vfx": "animation.gm1_ord.eggmobile.outro_vfx",
                "outro_vfx_controller":"controller.animation.gm1_ord.eggman.death_vfx",
                "fight_controller": "controller.animation.gm1_ord.eggman.fight",
                //gadget_swoop
                "swoop_charge": "animation.gm1_ord.eggmobile.swoop_charge",
                "swoop_attack": "animation.gm1_ord.eggmobile.swoop_attack",
                "swoop_charge_sfx":"animation.gm1_ord.eggmobile_swoop.charge_sfx",
                "swoop_attack_sfx":"animation.gm1_ord.eggmobile_swoop.attack_sfx",
                "gadget_swoop_controller": "controller.animation.gm1_ord.eggman.gadget_swoop",
                //bits
                "spikes_hidden": "animation.gm1_ord.eggmobile.spikes_hidden",
                "spikes_extend": "animation.gm1_ord.eggmobile.spikes_extend",
                "spikes_extend_sfx": "animation.gm1_ord.eggmobile.spikes_extend_sfx",
                "spikes_retract": "animation.gm1_ord.eggmobile.spikes_retract_sfx",
                "spikes_retract_sfx": "animation.gm1_ord.eggmobile.spikes_retract",
                "wings_hidden": "animation.gm1_ord.eggmobile.wings_hidden",
                "wings_extend": "animation.gm1_ord.eggmobile.wings_extend",
                "wings_retract": "animation.gm1_ord.eggmobile.wings_retract",
                "balls_hidden": "animation.gm1_ord.eggmobile.balls_hidden",
                "balls_extend": "animation.gm1_ord.eggmobile.balls_extend",
                "balls_retract": "animation.gm1_ord.eggmobile.balls_retract",
                "coils_hidden": "animation.gm1_ord.eggmobile.coils_hidden",
                "coils_extend": "animation.gm1_ord.eggmobile.coils_extend",
                "coils_retract": "animation.gm1_ord.eggmobile.coils_retract",
                "headlight_red_hidden": "animation.gm1_ord.eggmobile.headlight_red_hidden",
                "headlight_red_extend": "animation.gm1_ord.eggmobile.headlight_red_extend",
                "headlight_red_retract": "animation.gm1_ord.eggmobile.headlight_red_retract",
                //gadget_laser
                "laser_hidden":"animation.gm1_ord.eggmobile.laser_hidden",
                "laser_extend": "animation.gm1_ord.eggmobile.laser_extend",
                "laser_idle":"animation.gm1_ord.eggmobile.laser_idle",
                "laser_charge": "animation.gm1_ord.eggmobile.laser_charge",
                "laser_charge_hold": "animation.gm1_ord.eggmobile.laser_charge_hold",
                "laser_track": "animation.gm1_ord.eggmobile.laser_track",
                "laser_shoot": "animation.gm1_ord.eggmobile.laser_shoot",
                "laser_retract": "animation.gm1_ord.eggmobile.laser_retract",
                "gadget_laser_controller": "controller.animation.gm1_ord.eggman.gadget_laser",
                //laser sfx/vfx
                "laser.offset": "animation.gm1_ord.laser.offset",
                "laser.tracking": "animation.gm1_ord.laser",
                "laser.charging": "animation.gm1_ord.laser.ball_charge",
                "laser.blasting": "animation.gm1_ord.laser.shoot",
                "laser.default_pose": "animation.gm1_ord.laser.default_pose",
                "laser.controller": "controller.animation.gm1_ord.eggman_laser",
                "ac.laser.focus": "controller.animation.gm1_ord.eggman.laser_focus",
                "laser_track_sfx": "animation.gm1_ord.eggmobile_laser.track_sfx",
                "laser_track_lock_sfx": "animation.gm1_ord.eggmobile_laser.track_lock_sfx",
                "laser_charge_sfx": "animation.gm1_ord.eggmobile_laser.charge_sfx",
                "laser_shoot_sfx": "animation.gm1_ord.eggmobile_laser.shoot_sfx",
                "stun_vfx_controller": "controller.animation.gm1_ord.eggman.stun_vfx",
                "charging_gadget": "animation.gm1_ord.eggmobile.charging_gadget",
                //gadget launchers
                "launchers_charge_sfx": "animation.gm1_ord.eggmobile_launchers.charge_sfx",
                "launchers_shoot_sfx": "animation.gm1_ord.eggmobile_launchers.shoot_sfx",
                "all_launchers_hidden": "animation.gm1_ord.eggmobile.all_launchers_hidden",
                "launcher_bsr_extend": "animation.gm1_ord.eggmobile.launcher_bsr_extend",
                "launcher_br_extend": "animation.gm1_ord.eggmobile.launcher_br_extend",
                "launcher_bsl_extend": "animation.gm1_ord.eggmobile.launcher_bsl_extend",
                "launcher_bl_extend": "animation.gm1_ord.eggmobile.launcher_bl_extend",
                "launchers_idle": "animation.gm1_ord.eggmobile.launchers_idle",
                "launchers_charge": "animation.gm1_ord.eggmobile.launchers_charge",
                "launchers_shoot": "animation.gm1_ord.eggmobile.launchers_shoot",
                "launcher_bsr_retract": "animation.gm1_ord.eggmobile.launcher_bsr_retract",
                "launcher_br_retract": "animation.gm1_ord.eggmobile.launcher_br_retract",
                "launcher_bsl_retract": "animation.gm1_ord.eggmobile.launcher_bsl_retract",
                "launcher_bl_retract": "animation.gm1_ord.eggmobile.launcher_bl_retract",
                "alarm_hidden": "animation.gm1_ord.eggmobile.alarm_hidden",
                "alarm_extend": "animation.gm1_ord.eggmobile.alarm_extend",
                "alarm_idle": "animation.gm1_ord.eggmobile.alarm_idle",
                "alarm_active": "animation.gm1_ord.eggmobile.alarm_active",
                "alarm_retract": "animation.gm1_ord.eggmobile.alarm_retract",
                "gadget_launchers_controller": "controller.animation.gm1_ord.eggman.gadget_launchers",
                //gadget_hand
                "hand_hidden": "animation.gm1_ord.eggmobile.hand_hidden",
                "hand_extend": "animation.gm1_ord.eggmobile.hand_extend",
                "hand_retract": "animation.gm1_ord.eggmobile.hand_retract",
                "hand_idle": "animation.gm1_ord.eggmobile.hand_idle",
                "recharge_sfx": "animation.gm1_ord.eggmobile.recharge_sfx",
                "gadget_hand_controller": "controller.animation.gm1_ord.eggman.gadget_hand",
                //gadget_eggrobo
                "hatch_deploy": "animation.gm1_ord.eggmobile.hatch_deploy",
                "hatch_open": "animation.gm1_ord.eggmobile.hatch_open",
                "hatch_close": "animation.gm1_ord.eggmobile.hatch_close",
                "eggrobo_deploy_sfx": "animation.gm1_ord.eggmobile.eggrobo_deploy_sfx",
                "gadget_eggrobo_controller": "controller.animation.gm1_ord.eggman.gadget_eggrobo",
                //theme
                "theme_intro_sfx": "animation.gm1_ord.eggmobile.theme_intro_sfx",
                "theme_outro_sfx": "animation.gm1_ord.eggmobile.theme_outro_sfx",
                "theme_loop_sfx": "animation.gm1_ord.eggmobile.theme_loop_sfx"
            },
            "sound_effects": {
                "launchers_charge_sfx": "eggmobile_launchers_charge",
                "launchers_shoot_sfx": "eggmobile_launchers_shoot",
                "laser_track_sfx": "eggmobile_laser_track",
                "laser_charge_sfx": "eggmobile_laser_charge",
                "laser_shoot_sfx": "eggmobile_laser_shoot",
                "stun_sfx": "eggmobile_stun",
                "stun_loop_sfx": "eggmobile_stun_loop",
                "prestun_sfx": "eggmobile_prestun",
                "engine_sfx": "eggmobile_engine",
                "damage_sfx": "eggmobile_damage",
                "ring_drop_sfx": "eggmobile_ring_drop",
                "gadget_sfx": "eggmobile_gadget",
                "recharge_sfx": "eggmobile_recharge",
                "swoop_charge_sfx": "eggmobile_swoop_charge",
                "swoop_attack_sfx": "eggmobile_swoop_attack",
                "spikes_extend_sfx": "eggmobile_spikes_extend",
                "spikes_retract_sfx": "eggmobile_spikes_retract",
                "swoop_attack_voice_sfx": "eggman_swoop_attack_voice",

                "eggrobo_deploy_sfx": "eggrobo_deploy",
                "eggrobo_charge_sfx": "eggrobo_charge",
                "theme_intro_sfx": "eggman_theme_intro",
                "theme_outro_sfx": "eggman_theme_outro",
                "theme_loop_sfx": "eggman_theme_loop"
            },
            "scripts": {
                "animate": [
                    "laser.controller",
                    "laser.offset",
                    "fight_controller",
                    "movement_controller",
                    "stun_controller",
                    "hit_controller",
                    "gadget_eggrobo_controller",
                    "gadget_swoop_controller",
                    "gadget_laser_controller",
                    "gadget_launchers_controller",
                    "gadget_hand_controller",
                    "stun_vfx_controller",
                    "outro_vfx_controller",
                    "thrusters",
                    "rotate_shield"
                ],
                "initialize": [
                    "v.negative = 0;",
                    "v.laser_rot_x = 0;",
                    "v.laser_rot_y = 0;",
                    "v.laser_offset_z = 0;",
                    "v.laser_offset_y = 0;",
                    "v.laser_length = 0;",
                    "v.rotation_to_camera_x = 0;",
                    "v.rotation_to_camera_y = 0;",
                    "v.active_gadget = 0;",
                    "v.is_charging_laser = 0;",
                    "v.is_charging_gadget = 0 ;",
                    "v.is_using_gadget = 0;",
                    "v.is_charging_swoop = 0;",
                    "v.is_using_swoop = 0;",
                    "v.is_dying = 0;",
                    "v.is_intro = 0;",
                    "v.current_health = query.health;",
                    "v.previous_health = v.current_health;",
                    "v.recently_damaged = 0;",
                    "v.recently_damaged_timer = 0;",
                    "v.recently_damaged_sinewave = 0;",
                    "v.is_orbiting = 0;",
                    "v.is_chasing = 0;",
                    "v.is_going_to_shrine = 0;",
                    "v.at_shrine = 0;",
                    "v.colour_ramp = 0;",
                    "v.laser_shoot_length = 0;",
                    "v.is_prestun = 0;",
                    "v.is_stunned = 0;",
                    "v.is_stunned_timer = 0;",
                    "v.is_swoop_attacking = 0;",
                    "v.is_charging_eggrobo = 0;",
                    "v.is_dropping_eggrobo = 0;",
                    "v.is_burnt = 0;"
                ],
                "pre_animation": [
                    "v.is_dying = query.property('gm1_ord:is_dying');",
                    "v.is_intro = query.property('gm1_ord:doing_intro');",
                    "v.current_health = query.health;",
                    "v.recently_damaged = v.current_health != v.previous_health ? 1 : v.recently_damaged;",
                    "v.recently_damaged_timer = v.recently_damaged == 1 || v.recently_damaged_timer > 0 ? v.recently_damaged_timer + 1 * query.delta_time : v.recently_damaged_timer;",
                    "v.recently_damaged_sinewave = 0.5 + math.sin(v.recently_damaged_timer * 900)*0.5;",
                    "v.recently_damaged_timer = v.recently_damaged_timer >= 1 ? 0 : v.recently_damaged_timer;",
                    "v.recently_damaged = v.recently_damaged_timer <= 0 ? 0 : v.recently_damaged;",
                    "v.previous_health = v.current_health;",
                    "v.laser_rot_x = v.laser_rot_x == 0 ? q.property('gm1_ord:laser_rot_x') : math.lerp(v.laser_rot_x, q.property('gm1_ord:laser_rot_x'), 0.5);",
                    "v.laser_rot_y = v.laser_rot_y == 0 ? q.property('gm1_ord:laser_rot_y') : math.lerp(v.laser_rot_y, q.property('gm1_ord:laser_rot_y'), 0.3);",
                    "v.laser_length = v.laser_length == 0 ? q.property('gm1_ord:laser_length') : math.lerp(v.laser_length, q.property('gm1_ord:laser_length'), 0.5);",
                    "v.laser_offset_y = query.property('gm1_ord:laser_offset_y');",
                    "v.laser_offset_z = query.property('gm1_ord:laser_offset_z');",
                    "v.is_charging_laser = query.property('gm1_ord:is_charging_laser');",
                    "v.is_shooting_laser = q.property('gm1_ord:is_shooting_laser');",
                    "v.rotation_to_camera_x = q.rotation_to_camera(0);",
                    "v.rotation_to_camera_y = q.rotation_to_camera(1);",
                    "v.active_gadget = query.property('gm1_ord:active_gadget');",
                    "v.is_charging_gadget = query.property('gm1_ord:is_charging_gadget');",
                    "v.is_using_gadget = query.property('gm1_ord:is_using_gadget');",
                    "v.is_charging_swoop = query.property('gm1_ord:is_charging_swoop_attack');",
                    "v.is_using_swoop = query.property('gm1_ord:is_swoop_attacking');",
                    "v.is_orbiting = query.property('gm1_ord:is_orbiting');",
                    "v.is_chasing = query.property('gm1_ord:is_chasing');",
                    "v.is_going_to_shrine = query.property('gm1_ord:is_going_to_shrine');",
                    "v.at_shrine = query.property('gm1_ord:at_shrine');",
                    "v.is_prestun = query.property('gm1_ord:about_to_be_stunned');",
                    "v.is_stunned = query.property('gm1_ord:is_stunned');",
                    "v.is_stunned_timer = v.is_stunned ? v.is_stunned_timer + 1 * query.delta_time : v.is_stunned_timer;",
                    "v.negative = v.is_stunned && v.is_stunned_timer <= 0.25 ? 1 : v.negative;",
                    "v.negative = v.is_stunned && v.is_stunned_timer > 0.25 && v.is_stunned_timer <= 0.5 ? 0 : v.negative;",
                    "v.negative = v.is_stunned && v.is_stunned_timer > 0.5 && v.is_stunned_timer <= 0.75 ? 1 : v.negative;",
                    "v.negative = v.is_stunned && v.is_stunned_timer > 0.75 ? 0 : v.negative;",
                    "v.is_stunned_timer = !v.is_stunned ? 0 : v.is_stunned_timer;",
                    "v.colour_ramp = (v.is_charging_laser || v.is_shooting_laser) && v.colour_ramp < 1 ? v.colour_ramp + 0.025 : v.colour_ramp;",
                    "v.colour_ramp = (!v.is_charging_laser && !v.is_shooting_laser) ? 0 : v.colour_ramp;",
                    "v.laser_shoot_length = v.is_shooting_laser ? math.lerp(v.laser_shoot_length, v.laser_length, 0.01)/100 : 0;",
                    "v.is_swoop_attacking = query.property('gm1_ord:is_swoop_attacking');",
                    "v.is_charging_eggrobo = query.property('gm1_ord:is_charging_eggrobo');",
                    "v.is_dropping_eggrobo = query.property('gm1_ord:is_dropping_eggrobo');"
                ]
            },
            "particle_effects": {
                "smoking": "gm1_ord:eggman_smoke",
                "eggmobile_explosion": "gm1_ord:eggmobile_explosion",
                "eggmobile_explosion_large": "gm1_ord:eggmobile_large_explosion",
                "stun": "gm1_ord:eggman_stunned",
                "charge": "gm1_ord:charge_egg"
            },
            "spawn_egg": { "base_color": "#a80707", "overlay_color": "#fff700" }
        }
    }
}